#!/usr/bin/env python3

import scanner, optparse


def get_target_url():
    parser = optparse.OptionParser()
    parser.add_option("-u", "--url", dest="target_url", help="Specify a target url.")
    options = parser.parse_args()[0]

    if not options.target_url:
        options.target_url = input("Specify a target url --> ")
    return options.target_url


target_url = get_target_url()
links_to_ignore = ["http://10.0.2.5/dvwa/logout.php"]


# login process
data_dict = { "username": "admin", "password": "password", "Login": "submit" }

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://10.0.2.5/dvwa/login.php", data=data_dict)


# Running scanner
print(scanner.bColors.red + "\n\n[+++] All the links:")
vuln_scanner.crawl() # Getting all the links
print("\n\n")
vuln_scanner.run_scanner()